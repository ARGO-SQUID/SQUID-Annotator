annotate = {

  init: function(){
    $('#close-annotation').click(function(){
      annotate.closeAnnotationView()
    })
  },

  closeAnnotationView: function(){
    $('#annotation-view-container').removeClass('active')
    $('#annotation-view-container #inner-annotation-container').html("")
  },

  launchForLocation: function(location){
    $('#annotation-view-container').addClass('active')
    var annotateHtml = Mustache.to_html($('#annotate-location-template').html(), location)
    $('#annotation-view-container #inner-annotation-container').html(annotateHtml)
    anno.makeAnnotatable(document.getElementById('annotate-image'));
    // anno.addHandler('onAnnotationCreated', function(annotation) {
    //   console.log(annotation)
    // })
  },

  annotationViewMode: function(){
    return $('#annotation-view-container').hasClass('active')
  },

  updateAnnotation: function(annotation){
    alert('hit this update')
    console.log(annotation)
  },
  createAnnotation: function(annotation){
    console.log(annotation.shapes)
    $.ajax({
      type: "POST",
      url: apiHost + "/api/v1/annotations",
      data: {annotation: {location_id: annotation.locationId,
                          text: annotation.text,
                          image_url: annotation.src,
                          category: annotation.category,
                          height: annotation.shapes[0].geometry.height,
                          width: annotation.shapes[0].geometry.width,
                          x: annotation.shapes[0].geometry.x,
                          y: annotation.shapes[0].geometry.y,
                          shape: annotation.shapes[0].type}},
      success: function(data){
        alert('saved!')
      },
      error: function(data){
        alert("Sorry, we couldn't favorite this story for you right now. Please try again.")
      }
    });
  }

}
